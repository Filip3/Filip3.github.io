<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    
    
    <title>Orchestrating a Fresh Environment Setup Â· Malenko</title>

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    
    <link rel="stylesheet" href="/style.main.min.5ea2f07be7e07e221a7112a3095b89d049b96c48b831f16f1015bf2d95d914e5.css" />
    <link rel="shortcut icon" href="./images/avatar.ico">
</head>
<body class=" post-template ">

    <div class="site-wrapper">

<header class="site-header"><div class="outer site-nav-main">
    <div class="inner"><nav class="site-nav">
    <div class="site-nav-left">
        
            <a class="site-nav-logo" href="/"><img src="/images/avatar.png" alt="Malenko" /></a>
        
        
        <div class="site-nav-content">
            <ul class="nav" role="menu">
                
                <li class="nav-home" role="menuitem"><a href="https://github.com/Filip3">github</a></li>
                
                <li class="nav-home" role="menuitem"><a href="https://stackoverflow.com/users/3910333/malenko">stackoverflow</a></li>
                
                <li class="nav-home" role="menuitem"><a href="https://www.linkedin.com/in/filipmalenko">linkedin</a></li>
                
                <li class="nav-home" role="menuitem"><a href="https://www.xing.com/profile/Filip_Malenko">xing</a></li>
                
            </ul>
        </div>
        
    </div>
</nav>

</div>
</div></header>

<main id="site-main" class="site-main outer">
    <div class="inner">

        <article class="post-full post  no-image ">

            <header class="post-full-header">

                
                    
                    <section class="post-full-tags">
                        <a href="/tags/ansible">Ansible</a>
                    </section>
                

                <h1 class="post-full-title">Orchestrating a Fresh Environment Setup</h1>

                

                <div class="post-full-byline">
                    <section class="post-full-byline-content">

                        <ul class="author-list">
    <li class="author-list-item">
        <div class="author-card">
            <div class="author-profile-image"><img src="../../images/avatar.png" alt="Malenko"></div>
            <div class="author-info">
                <div class="author-info">
                    <h2>Filip</h2>
                </div>
            </div>
        </div>
        <a href="#" class="author-avatar author-profile-image"><img src="../../images/avatar.png" alt="Malenko"></a>
    </li>
</ul>

                        <section class="post-full-byline-meta">
                            
                                <h4 class="author-name">Filip</h4>
                            
                            <div class="byline-meta-content">
                                <time class="byline-meta-date" datetime="2020-1212-12">22 December 2020</time>
                                <span class="byline-reading-time"><span class="bull">&bull;</span> 6 min read</span>
                            </div>
                        </section>

                    </section>


                </div>
            </header>

            

            <section class="post-full-content">
                <div class="post-content">
                    <h1 id="orchestrating-a-fresh-environment">Orchestrating a Fresh Environment</h1>
<h6 id="_the-following-section-will-contain-some-ranting_"><em>The following section will contain some ranting.</em></h6>
<p><em>Please feel free to skip at your own choice.</em></p>
<p>Why? Why not just install everything and be done with it. Just do whatever you want and need, set up your environment on a whim without any consequences. Well, that is a good question, and an answer would be that I decided to learn a new approach(or tool) that would help me in my everyday work life. And the best way to start learning something is to try and find a way to apply it to one obscure corner of your personal or work life. And this dark unvisited corner was my personal OS setup. And as we are all aware this is a task that happens once in a full moon on a leap year. It is a daunting and seldom done task of necessity only reserved for times when you have some sort of a spiritual crisis and you question the stability of reality to try to redo your fragile and working environment.</p>
<p>The first thing that popped in mind is to just set up everything by hand and be done with it. But at the same time, I wanted(you may also say needed) a way of keeping up all my history of changes during my long setup and installations without the need to try to rethink them each time I did something. I wanted to have the power to not remember, but to write it down. As the saying goes a somewhat smart person writes things down, and the other(Who would know who this other person is) tries to remember. All this dark magic would do all my bidding, be the one that runs menial tasks, be the one that takes charge and be responsible for keeping the environment up to date(you might even say modern and in with the times). Make me follow all the new edgy things, even when my mind forgets. And let me tell you I do not care about following trends, but I do care when I am missing an improvement that would simplify or remove some manual task.</p>
<p>Imagine having not to be an operations person, but you are introduced to a culture that brings people together. Yes, just imagine that bringing people close, what dark sorcery is this. People, working closer and more open, blasphemy I say. You might say this sounds familiar, there are all these buzzwords out there, and cultures that promise the same. Well they promise and they deliver to some level, and this is just another buzz going around. But I say why not if we can find just a couple of small tricks or AHA moments that can do something for us in reaching our goals.</p>
<p>Besides the feeling that I was on only one side of the coin, I wanted to see how this can be achieved with some of the automation tools that are out there and are open-source. And to be honest, starting to explore and expand on this new approach and tool. Made time and space stop. Well yes, why did it. It did because of this fun thing you have when you try to apply something you learned, something new in software engineering. Time stops because sometimes you have so much fun, and other times you get blocked and never notice that time around you is just passing by. While all the time you are stuck in this fishbowl circling like a little golden fish.</p>
<p>So let&rsquo;s get to it.</p>
<h2 id="get-down-to-the-nitty-gritty">Get down to the nitty-gritty</h2>
<h6 id="_and-yet-again-a-start-of-another-shorter-rant_"><em>And yet again a start of another shorter rant.</em></h6>
<p>In a world of too much manual work, you need a conductor that will gather the misplaced manual laborers into a well-sounding orchestra and produce wonderful results. <a href="https://www.ansible.com/">Ansible</a> is here to do the conducting, and gather all these different tools and approach and conduct them into a smooth sounding opera.</p>
<p>A half automated way of orchestrating your local environment can be started by following some steps.
<em>Please do keep in mind that most steps if not all of them will require elevated rights.</em></p>
<p>We start by giving some more humph to our windows PowerShell by executing some basic commands.
First what we do is change our <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.security/set-executionpolicy?view=powershell-7.1">Set-ExecutionPolicy</a>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">PS&gt; Set-ExecutionPolicy Bypass -Scope <span style="color:#66d9ef">Process</span> -Force
</code></pre></div><p>Next, we need to do some stage setup and for this, we require to do some additional changes to our windows.
Enable the Virtual Machine Platform optional component on Windows.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">PS&gt; dism.exe /online /enable-feature /featurename<span style="color:#960050;background-color:#1e0010">:</span>VirtualMachinePlatform /all /norestart
</code></pre></div><h3 id="install-windows-terminal">Install Windows Terminal</h3>
<p>There are 3 different ways to install Windows Terminal:</p>
<ul>
<li>From the Windows Store
<ul>
<li><a href="https://www.microsoft.com/de-de/p/windows-terminal-preview/9n0dx20hk701?activetab=pivot:overviewtab">Windows Terminal</a></li>
</ul>
</li>
<li>From GitHub
<ul>
<li><a href="https://github.com/microsoft/terminal">Windows Terminal</a></li>
</ul>
</li>
<li>Using Chocolatey
<ul>
<li><a href="https://chocolatey.org/packages/microsoft-windows-terminal/">Windows Terminal</a></li>
</ul>
</li>
</ul>
<p>Or you can leave it to the task included in the common role, which would install Windows Terminal for you. <em>For this you need to have a way to start the orchestra from some other Linux machine. Either a container or another machine.</em></p>
<p>After installing it you can set up a shortcut that would always run your Terminal in Administrator Rights.</p>
<ul>
<li>Right-click on Desktop and create a new Shortcut</li>
<li>In Location input: <code>cmd  C:\Windows\system32\cmd.exe /c start /b wt</code></li>
<li>As Name input: Windows Terminal</li>
<li>And as a final step, right-click into properties -&gt; Advanced and check the option to &ldquo;Run as Administrator&rdquo;</li>
</ul>
<h3 id="windows-subsystem-for-linux">Windows Subsystem for Linux</h3>
<p>This feature can be installed from the Ansible roles. But since this is a local setup using WSL itself. We would have to do it earlier, so we can use it to run the ansible-playbook.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">PS&gt; Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux
<span style="color:#75715e"># Restart machine</span>
<span style="color:#75715e"># A distro version can be chosen from the list provided by MSFT.</span>
PS&gt; Invoke-WebRequest -Uri https<span style="color:#960050;background-color:#1e0010">:</span>//aka.ms/wsl-ubuntu-1804 -OutFile Ubuntu.appx -UseBasicParsing
PS&gt; Add-AppxPackage .\Ubuntu.appx
PS&gt; ~\AppData\Local\Microsoft\WindowsApps\Ubuntu.exe
</code></pre></div><p>After installing the distro version you can configure WSL 2 as a default version.</p>
<p><em>At the moment WSL 2 doesn&rsquo;t provide an easy way to communicate with the windows host, and Ansible cannot be executed without temporary workarounds.</em></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">wsl --set-default-version <span style="color:#ae81ff">2</span>
</code></pre></div><h4 id="install-ansible-and-add-additional-packages-within-wsl">Install Ansible and add additional packages within WSL</h4>
<p>Install packages and update the distro with the following commands:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$&gt; sudo apt-get update
$&gt; sudo apt-get upgrade
$&gt; sudo apt-get install socat
$&gt; sudo apt-get install git
$&gt; sudo apt-get install zulu-11
$&gt; sudo apt-get install software-properties-common
$&gt; sudo apt-add-repository -y --update ppa:ansible/ansible
$&gt; sudo apt install ansible
</code></pre></div><h3 id="and-what-it-boils-down-to-what-the-conductor-reads-and-conducts-to-the-orchestra">And what it boils down to, what the Conductor reads and conducts to the orchestra</h3>
<p>After everything, all the torture in our little fishbowl, we get to hear what Ansible can do for us.
And it all starts with:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ansible-playbook freshinstall.yml -i hosts/inventory.yml
</code></pre></div><p>The residing spot of this example can be found in <a href="https://github.com/Filip3/AnsibleFreshInstall">AnsibleFreshInstall: Setting up a local environment from scratch, with an Ansible script.</a>.</p>
<p><em>Please check the readme of the project. It might contain added details.</em></p>

                </div>
            </section>

        </article>

    </div>
</main>
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
    
    <article class="read-next-card">
        <header class="read-next-card-header">
            <h3><span>More in</span> <a href="/tags/ansible">Ansible</a></h3>
        </header>
        <div class="read-next-card-content">
            <ul>
                
            </ul>
        </div>
    </article>


            <article class="post-card post


 ">

        
            <a class="post-card-image-link" href="/posts/gitlab-ci-nuget-versioning-build-and-upload/">
                <img class="post-card-image"src="../../images/mika-baumeister-WOn90Iui_08-unsplash.jpg" alt="Automating NuGet Version, Restore, Build, Pack and Upload"/>
            </a>
        
    
        <div class="post-card-content">
    
            <a class="post-card-content-link" href="/posts/gitlab-ci-nuget-versioning-build-and-upload/">
    
                <header class="post-card-header">
                    
                        
                        <div class="post-card-primary-tag">CI/CD</div>
                    

                    <h2 class="post-card-title">Automating NuGet Version, Restore, Build, Pack and Upload</h2>
                </header>
    
                <section class="post-card-excerpt">
                    <p>Why would I go through this tedious process to create this small NuGet of maybe gold, maybe silver, maybe just some invaluable thing. Unless I try I wouldn&rsquo;t know. And that&rsquo;s how I start each time when I see I am repeating tasks.
As you type your day away, you turn around and see a small simple chunk of code that you think, hey, this guy here, he would be a handful in other places than just this lonely solution here.</p>
                </section>
    
            </a>

            <footer class="post-card-meta">
                    <ul class="author-list">
                        <li class="author-list-item">
                            <div class="author-name-tooltip">Filip</div>
                            <a href="https://test.com" class="static-avatar author-profile-image"><img src="../../images/avatar.png" alt="Malenko"></a>
                        </li>
                    </ul>
                    <div class="post-card-byline-content">
                        <span>Filip</span>
                        <span class="post-card-byline-date"><time datetime="2021-121-01">30 January 2021</time>
                            <span class="bull">&bull;</span> 5 min read</span>
                    </div>
                </footer>
    
        </div>

</article>
    
        </div>
    </div>
</aside>


        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="/">Malenko</a> &copy; 2020</section>
                <nav class="site-footer-nav">
                    <a href="/">Latest Posts</a>
                    
                    <a href="https://twitter.com/filipmalenko" target="_blank" rel="noopener">Twitter</a>
                    <a href="https://github.com/Filip3" target="_blank" rel="noopener">Github</a>
                </nav>
            </div>
        </footer>

    </div>

</body>
</html>